plot(Agglo, pch = 21,
cex = 0.1 * sqrt(Agglo@data$Pop1989 / pi),
col = "black", bg = Agglo@data$decrease,add = TRUE)
Agglo@data$decrease
Agglo@data$decrease[decrease == "red"]
Agglo@data[decrease == "red"]
Agglo@data[decrease == "red"]
deacrease <- subset(Agglo@data,decrease == "red")
deacrease
ekat <- subset(Agglo@data, name == "Iekaterinbourg")
ekat
ekat <- subset(Agglo@data, name == "Yekaterinbourg")
ekat
ekat <- subset(Agglo@data, name == "Ekaterinbourg")
ekat
Agglo@data
head(Agglo@data)
deacrease
balances <- read.csv("/Users/clementinecottineau/Documents/Géographie/articles/Article-EPS/composante-croissance1991-2010/NAT-MIG-1991-2010-agglos-type2.csv", sep=",", dec=".")
summary(balances)
balances$TYP1991 <- ifelse(balances$TYP1991 == "NAT", NA, balances$TYP1991 )
balances$TYP1991 <- ifelse(balances$TYP1991 == "NAT", NA, balances$TYP1991 )
balances$TYP1992 <- ifelse(balances$TYP1992 == "NAT", NA, balances$TYP1992 )
balances$TYP1993 <- ifelse(balances$TYP1993 == "NAT", NA, balances$TYP1993 )
balances$TYP1994 <- ifelse(balances$TYP1994 == "NAT", NA, balances$TYP1994 )
balances$TYP1995 <- ifelse(balances$TYP1995 == "NAT", NA, balances$TYP1995 )
balances$TYP1996 <- ifelse(balances$TYP1996 == "NAT", NA, balances$TYP1996 )
balances$TYP1997 <- ifelse(balances$TYP1997 == "NAT", NA, balances$TYP1997 )
balances$TYP1998 <- ifelse(balances$TYP1998 == "NAT", NA, balances$TYP1998 )
balances$TYP1999 <- ifelse(balances$TYP1999 == "NAT", NA, balances$TYP1999 )
balances$TYP2000 <- ifelse(balances$TYP2000 == "NAT", NA, balances$TYP2000 )
balances$TYP2001 <- ifelse(balances$TYP2001 == "NAT", NA, balances$TYP2001 )
balances$TYP2002 <- ifelse(balances$TYP2002 == "NAT", NA, balances$TYP2002 )
balances$TYP2003 <- ifelse(balances$TYP2003 == "NAT", NA, balances$TYP2003 )
balances$TYP2004 <- ifelse(balances$TYP2004 == "NAT", NA, balances$TYP2004 )
balances$TYP2005 <- ifelse(balances$TYP2005 == "NAT", NA, balances$TYP2005 )
balances$TYP2006 <- ifelse(balances$TYP2006 == "NAT", NA, balances$TYP2006 )
balances$TYP2007 <- ifelse(balances$TYP2007 == "NAT", NA, balances$TYP2007 )
balances$TYP2008 <- ifelse(balances$TYP2008 == "NAT", NA, balances$TYP2008 )
balances$TYP2009 <- ifelse(balances$TYP2009 == "NAT", NA, balances$TYP2009 )
balances$TYP2010 <- ifelse(balances$TYP2010 == "NAT", NA, balances$TYP2010 )
summary(balances)
summary(balances)
balances <- read.csv("/Users/clementinecottineau/Documents/Géographie/articles/Article-EPS/composante-croissance1991-2010/NAT-MIG-1991-2010-agglos-type2.csv", sep=",", dec=".")
summary(balances)
balances$TYP1991 <- ifelse(balances$TYP1991 == "NAT", NA, balances$TYP1991 )
summary(balances)
head(balances)
deacrease
test <- subset(balances,TYP1991 == "NAT")
test
head(balances)
tail(balances)
str(balances)
test <- subset(balances,TYP1991 == " NAT")
test
balances <- read.csv("/Users/clementinecottineau/Documents/Géographie/articles/Article-EPS/composante-croissance1991-2010/NAT-MIG-1991-2010-agglos-type2.csv", sep=",", dec=".")
str(balances)
test <- subset(balances,TYP1991 == " NAT")
test
balances <- read.csv("/Users/clementinecottineau/Documents/Géographie/articles/Article-EPS/composante-croissance1991-2010/NAT-MIG-1991-2010-agglos-type2.csv", sep=",", dec=".")
str(balances)
balances$TYP1991 <- ifelse(balances$TYP1991 == " NAT", NA, balances$TYP1991 )
balances$TYP1992 <- ifelse(balances$TYP1992 == " NAT", NA, balances$TYP1992 )
balances$TYP1993 <- ifelse(balances$TYP1993 == " NAT", NA, balances$TYP1993 )
balances$TYP1994 <- ifelse(balances$TYP1994 == " NAT", NA, balances$TYP1994 )
balances$TYP1995 <- ifelse(balances$TYP1995 == " NAT", NA, balances$TYP1995 )
balances$TYP1996 <- ifelse(balances$TYP1996 == " NAT", NA, balances$TYP1996 )
balances$TYP1997 <- ifelse(balances$TYP1997 == " NAT", NA, balances$TYP1997 )
balances$TYP1998 <- ifelse(balances$TYP1998 == " NAT", NA, balances$TYP1998 )
balances$TYP1999 <- ifelse(balances$TYP1999 == " NAT", NA, balances$TYP1999 )
balances$TYP2000 <- ifelse(balances$TYP2000 == " NAT", NA, balances$TYP2000 )
balances$TYP2001 <- ifelse(balances$TYP2001 == " NAT", NA, balances$TYP2001 )
balances$TYP2002 <- ifelse(balances$TYP2002 == " NAT", NA, balances$TYP2002 )
balances$TYP2003 <- ifelse(balances$TYP2003 == " NAT", NA, balances$TYP2003 )
balances$TYP2004 <- ifelse(balances$TYP2004 == " NAT", NA, balances$TYP2004 )
balances$TYP2005 <- ifelse(balances$TYP2005 == " NAT", NA, balances$TYP2005 )
balances$TYP2006 <- ifelse(balances$TYP2006 == " NAT", NA, balances$TYP2006 )
balances$TYP2007 <- ifelse(balances$TYP2007 == " NAT", NA, balances$TYP2007 )
balances$TYP2008 <- ifelse(balances$TYP2008 == " NAT", NA, balances$TYP2008 )
balances$TYP2009 <- ifelse(balances$TYP2009 == " NAT", NA, balances$TYP2009 )
balances$TYP2010 <- ifelse(balances$TYP2010 == " NAT", NA, balances$TYP2010 )
balances$TYP1991 <- ifelse(balances$TYP1991 == " MIG", NA, balances$TYP1991 )
balances$TYP1992 <- ifelse(balances$TYP1992 == " MIG", NA, balances$TYP1992 )
balances$TYP1993 <- ifelse(balances$TYP1993 == " MIG", NA, balances$TYP1993 )
balances$TYP1994 <- ifelse(balances$TYP1994 == " MIG", NA, balances$TYP1994 )
balances$TYP1995 <- ifelse(balances$TYP1995 == " MIG", NA, balances$TYP1995 )
balances$TYP1996 <- ifelse(balances$TYP1996 == " MIG", NA, balances$TYP1996 )
balances$TYP1997 <- ifelse(balances$TYP1997 == " MIG", NA, balances$TYP1997 )
balances$TYP1998 <- ifelse(balances$TYP1998 == " MIG", NA, balances$TYP1998 )
balances$TYP1999 <- ifelse(balances$TYP1999 == " MIG", NA, balances$TYP1999 )
balances$TYP2000 <- ifelse(balances$TYP2000 == " MIG", NA, balances$TYP2000 )
balances$TYP2001 <- ifelse(balances$TYP2001 == " MIG", NA, balances$TYP2001 )
balances$TYP2002 <- ifelse(balances$TYP2002 == " MIG", NA, balances$TYP2002 )
balances$TYP2003 <- ifelse(balances$TYP2003 == " MIG", NA, balances$TYP2003 )
balances$TYP2004 <- ifelse(balances$TYP2004 == " MIG", NA, balances$TYP2004 )
balances$TYP2005 <- ifelse(balances$TYP2005 == " MIG", NA, balances$TYP2005 )
balances$TYP2006 <- ifelse(balances$TYP2006 == " MIG", NA, balances$TYP2006 )
balances$TYP2007 <- ifelse(balances$TYP2007 == " MIG", NA, balances$TYP2007 )
balances$TYP2008 <- ifelse(balances$TYP2008 == " MIG", NA, balances$TYP2008 )
balances$TYP2009 <- ifelse(balances$TYP2009 == " MIG", NA, balances$TYP2009 )
balances$TYP2010 <- ifelse(balances$TYP2010 == " MIG", NA, balances$TYP2010 )
summary(balances)
balances <- read.csv("/Users/clementinecottineau/Documents/Géographie/articles/Article-EPS/composante-croissance1991-2010/NAT-MIG-1991-2010-agglos-type2.csv", sep=",", dec=".")
str(balances)
balances$TYP1991 <- ifelse(balances$TYP1991 == " NAT", NA, )
balances$TYP1991 <- if(balances$TYP1991 == " NAT") NA
balances$TYP1991 <- if(balances$TYP1991 == " NAT") balances$TYP1991 = NA
if(balances$TYP1991 == " NAT") balances$TYP1991 <- NA
balances <- read.csv("/Users/clementinecottineau/Documents/Géographie/articles/Article-EPS/composante-croissance1991-2010/NAT-MIG-1991-2010-agglos-type2.csv", sep=",", dec=".")
str(balances)
balances$TYP1991 <- ifelse(balances$TYP1991 == " NAT", NA, balances$TYP1991 )
str(balances)
balances <- read.csv("/Users/clementinecottineau/Documents/Géographie/articles/Article-EPS/composante-croissance1991-2010/NAT-MIG-1991-2010-agglos-type2.csv", sep=",", dec=".")
str(balances)
balances$TYP1991 <- ifelse(balances$TYP1991 == " NAT", NA, as.factor(balances$TYP1991 ))
str(balances)
balances <- read.csv("/Users/clementinecottineau/Documents/Géographie/articles/Article-EPS/composante-croissance1991-2010/NAT-MIG-1991-2010-agglos-type2.csv", sep=",", dec=".")
str(balances)
balances$TYP1991 <- ifelse(balances$TYP1991 == " NAT", NA, as.character(balances$TYP1991 ))
str(balances)
balances$TYP1992 <- ifelse(balances$TYP1992 == " NAT", NA, as.character(balances$TYP1992 ))
balances$TYP1993 <- ifelse(balances$TYP1993 == " NAT", NA, as.character(balances$TYP1993 ))
balances$TYP1994 <- ifelse(balances$TYP1994 == " NAT", NA, as.character(balances$TYP1994 ))
balances$TYP1995 <- ifelse(balances$TYP1995 == " NAT", NA, as.character(balances$TYP1995 ))
balances$TYP1996 <- ifelse(balances$TYP1996 == " NAT", NA, as.character(balances$TYP1996 ))
balances$TYP1997 <- ifelse(balances$TYP1997 == " NAT", NA, as.character(balances$TYP1997 ))
balances$TYP1998 <- ifelse(balances$TYP1998 == " NAT", NA, as.character(balances$TYP1998 ))
balances$TYP1999 <- ifelse(balances$TYP1999 == " NAT", NA, as.character(balances$TYP1999 ))
balances$TYP2000 <- ifelse(balances$TYP2000 == " NAT", NA, as.character(balances$TYP2000 ))
balances$TYP2001 <- ifelse(balances$TYP2001 == " NAT", NA, as.character(balances$TYP2001 ))
balances$TYP2002 <- ifelse(balances$TYP2002 == " NAT", NA, as.character(balances$TYP2002 ))
balances$TYP2003 <- ifelse(balances$TYP2003 == " NAT", NA, as.character(balances$TYP2003 ))
balances$TYP2004 <- ifelse(balances$TYP2004 == " NAT", NA, as.character(balances$TYP2004 ))
balances$TYP2005 <- ifelse(balances$TYP2005 == " NAT", NA, as.character(balances$TYP2005 ))
balances$TYP2006 <- ifelse(balances$TYP2006 == " NAT", NA, as.character(balances$TYP2006 ))
balances$TYP2007 <- ifelse(balances$TYP2007 == " NAT", NA, as.character(balances$TYP2007 ))
balances$TYP2008 <- ifelse(balances$TYP2008 == " NAT", NA, as.character(balances$TYP2008 ))
balances$TYP2009 <- ifelse(balances$TYP2009 == " NAT", NA, as.character(balances$TYP2009 ))
balances$TYP2010 <- ifelse(balances$TYP2010 == " NAT", NA, as.character(balances$TYP2010 ))
balances$TYP1991 <- ifelse(balances$TYP1991 == " MIG", NA, as.character(balances$TYP1991 ))
balances$TYP1992 <- ifelse(balances$TYP1992 == " MIG", NA, as.character(balances$TYP1992 ))
balances$TYP1993 <- ifelse(balances$TYP1993 == " MIG", NA, as.character(balances$TYP1993 ))
balances$TYP1994 <- ifelse(balances$TYP1994 == " MIG", NA, as.character(balances$TYP1994 ))
balances$TYP1995 <- ifelse(balances$TYP1995 == " MIG", NA, as.character(balances$TYP1995 ))
balances$TYP1996 <- ifelse(balances$TYP1996 == " MIG", NA, as.character(balances$TYP1996 ))
balances$TYP1997 <- ifelse(balances$TYP1997 == " MIG", NA, as.character(balances$TYP1997 ))
balances$TYP1998 <- ifelse(balances$TYP1998 == " MIG", NA, as.character(balances$TYP1998 ))
balances$TYP1999 <- ifelse(balances$TYP1999 == " MIG", NA, as.character(balances$TYP1999 ))
balances$TYP2000 <- ifelse(balances$TYP2000 == " MIG", NA, as.character(balances$TYP2000 ))
balances$TYP2001 <- ifelse(balances$TYP2001 == " MIG", NA, as.character(balances$TYP2001 ))
balances$TYP2002 <- ifelse(balances$TYP2002 == " MIG", NA, as.character(balances$TYP2002 ))
balances$TYP2003 <- ifelse(balances$TYP2003 == " MIG", NA, as.character(balances$TYP2003 ))
balances$TYP2004 <- ifelse(balances$TYP2004 == " MIG", NA, as.character(balances$TYP2004 ))
balances$TYP2005 <- ifelse(balances$TYP2005 == " MIG", NA, as.character(balances$TYP2005 ))
balances$TYP2006 <- ifelse(balances$TYP2006 == " MIG", NA, as.character(balances$TYP2006 ))
balances$TYP2007 <- ifelse(balances$TYP2007 == " MIG", NA, as.character(balances$TYP2007 ))
balances$TYP2008 <- ifelse(balances$TYP2008 == " MIG", NA, as.character(balances$TYP2008 ))
balances$TYP2009 <- ifelse(balances$TYP2009 == " MIG", NA, as.character(balances$TYP2009 ))
balances$TYP2010 <- ifelse(balances$TYP2010 == " MIG", NA, as.character(balances$TYP2010 ))
summary(balances)
write.csv(balances, "/Users/clementinecottineau/Dropbox/Paper_Russia_Irina/slider.csv")
marius <- read.csv(paste(path, "marius.csv", sep=""),sep=",",dec=".")
mariusstep0 <- subset(marius, step == 0)
mariusstep11 <- subset(marius, step == 11)
mariusstep20 <- subset(marius, step == 20)
mariusstep30 <- subset(marius, step == 30)
library(rgdal)
library(rgeos)
library(mapproj)
library(maptools)
library(RColorBrewer)
library(RCurl)
library(ggplot2)
library(reshape2)
library(grid)
marius <- read.csv(paste(path, "marius.csv", sep=""),sep=",",dec=".")
mariusstep0 <- subset(marius, step == 0)
mariusstep11 <- subset(marius, step == 11)
mariusstep20 <- subset(marius, step == 20)
mariusstep30 <- subset(marius, step == 30)
head(mariusstep30)
Agglo<-readOGR(dsn = "/Users/clementinecottineau/Documents/DARIUS_Shiny/Shape_files/DARIUS_points.shp" , layer = "DARIUS_points", encoding = "utf8", stringsAsFactors = FALSE, verbose = FALSE)
Shape <- "Shape"
assign(Shape, FSU_Reg)
head(Agglo@data)
table <- mariusstep30
Agglo@data <- data.frame(Agglo@data, table[match(Agglo@data$AROKATO,table$arokato), ])
head(Agglo@data)
Agglo@data$Residuals <- Agglo@data[,Year] / Agglo@data$population
head(Agglo@data)
my_palette <- colorRampPalette(c("dodgerblue", "seashell", "darkgoldenrod1"))(n = 299)
vPal9 <- rev(brewer.pal(n = 8, my_palette))
my_palette <- colorRampPalette(c("dodgerblue", "seashell", "darkgoldenrod1"))
my_palette(9)
Agglo<-readOGR(dsn = "/Users/clementinecottineau/Documents/DARIUS_Shiny/Shape_files/DARIUS_points.shp" , layer = "DARIUS_points", encoding = "utf8", stringsAsFactors = FALSE, verbose = FALSE)
Agglo <- Agglo[Agglo@data$country == "Russia", ]
library(rgdal)
library(rgeos)
library(mapproj)
library(maptools)
library(RColorBrewer)
library(RCurl)
library(ggplot2)
library(reshape2)
library(grid)
Agglo<-readOGR(dsn = "/Users/clementinecottineau/Documents/DARIUS_Shiny/Shape_files/DARIUS_points.shp" , layer = "DARIUS_points", encoding = "utf8", stringsAsFactors = FALSE, verbose = FALSE)
Agglo <- Agglo[Agglo@data$country == "Russia", ]
tail(Agglo@data)
# Simu PSE MARIUS
# Clémentine
# 9 Fev 2015
library(ggplot2)
path <- "/Users/clementinecottineau/ownCloud/behaviourspaceexploration/figures/patterns_marius/"
path<-"/Users/clementinecottineau/Documents/Géographie/articles/guillaume-romain/patterns_marius/"
## Import pattern files
HIEGRO <- read.csv(paste(path, "fortehierarchisation_fortecroissance.csv", sep=""),sep="",dec=".")
DEHGRO <- read.csv(paste(path, "dehierarchisation_croissance.csv", sep=""),sep="",dec=".")
DEHSHR <- read.csv(paste(path, "dehierarchisation_decroissance.csv", sep=""),sep="",dec=".")
HIERAR <- read.csv(paste(path, "tresfortehierarchisation.csv", sep=""),sep="",dec=".")
HIESHR <- read.csv(paste(path, "hierarchisation_decroissance.csv", sep=""),sep="",dec=".")
DEHGRO2INV <- read.csv(paste(path, "dehierarchisation_croissance_2inv.csv", sep=""),sep="",dec=".")
DEHSHR1INV <- read.csv(paste(path, "dehierarchisation_decroissance_1inv.csv", sep=""),sep="",dec=".")
HIEGRO2INV <- read.csv(paste(path, "hierarchisation_croissance_2inv.csv", sep=""),sep="",dec=".")
HIESHR1INV <- read.csv(paste(path, "hierarchisation_decroissance_1inv.csv", sep=""),sep="",dec=".")
selectParamToRun <- function(pattern){
x <- pattern
x$EM <- abs((x$economicMultiplier - 0.3438093442) / 0.3438093442)
x$SS <- abs((x$sizeEffectOnSupply - 1.001756388) / 1.001756388)
x$SD <- abs((x$sizeEffectOnDemand - 1.0792607803) / 1.0792607803)
x$WP <- abs((x$wealthToPopulationExponent - 0.3804356044) / 0.3804356044)
x$DD <- abs((x$distanceDecay - 0.6722631615) / 0.6722631615)
x$PW <- abs((x$populationToWealthExponent - 1.0866012754) / 1.0866012754)
x$BM <- abs((x$bonusMultiplier - 197.948890779) / 197.948890779)
x$FC <- abs((x$fixedCost - 0.256524806) / 0.256524806)
#x$DistToCalib <- x$SS + x$SD + x$DD + x$PW
x$DistToCalib <- x$SS + x$SD + x$DD + x$PW + x$EM + x$WP + x$BM + x$FC
dim(x)
sortedX <- x[order(x$DistToCalib) , ]
return(sortedX[1,])
}
drawRankSizeOfPattern <- function(pattern, patname){
marius <- read.csv(paste(path, pattern, "2.csv", sep=""),sep=",",dec=".")
step0 <- subset(marius, step == 0)
step11 <- subset(marius, step == 11)
step20 <- subset(marius, step == 20)
step30 <- subset(marius, step == 30)
head(step0)
step0 <- step0[order(-step0$population) , ]
step0 <- step0[,3]
step11 <- step11[order(-step11$population) , ]
step11 <- step11[,3]
step20 <- step20[order(-step20$population) , ]
step20 <- step20[,3]
step30 <- step30[order(-step30$population) , ]
step30 <- step30[,3]
ranks <- 1:1145
zipf0 <- as.data.frame(cbind (ranks, step0))
colnames(zipf0) <- c("ranks", "size")
zipf11 <- as.data.frame(cbind (ranks, step11))
colnames(zipf11) <- c("ranks", "size")
zipf20 <- as.data.frame(cbind (ranks, step20))
colnames(zipf20) <- c("ranks", "size")
zipf30 <- as.data.frame(cbind (ranks, step30))
colnames(zipf30) <- c("ranks", "size")
zipf <- rbind(zipf0, zipf11, zipf20, zipf30 )
date <- c(rep(1959, 1145),rep(1970, 1145),rep(1979, 1145), rep(1989, 1145))
zipf <- as.data.frame(cbind (zipf, date))
p <-ggplot(zipf, aes(x=ranks, y=size, group=date, fill=date, colour=date))
p + scale_y_log10(breaks=c(10, 100, 1000, 10000)) +
scale_x_log10(breaks=c(1, 10, 100, 1000)) +
xlab("Ranks") + ylab("Population (x1000)") +
#theme(plot.title = element_text(size = 20, face="bold" , family="Helvetica"), axis.text = element_text(family="Helvetica", face="bold"), panel.grid.major = element_line(size = 0.7, colour = "gray80"), panel.background = element_rect(fill = "white"), plot.background = element_rect(fill = "gray95", colour='black', size=0.3), panel.border = element_rect(fill=NA,color="black", size=0.3, linetype="solid")) +
geom_point() + geom_line() +
ggtitle(paste("Simulated Rank-Size Distribution | Pattern ", patname, "\n", sep=""))
}
patternA <- selectParamToRun(HIEGRO)
patternA
marius <- read.csv(paste(path, "marius.csv", sep=""),sep=",",dec=".")
head(marius)
calibration <- read.csv(paste(folder_path, "population", current_generation, ".csv", sep=""), dec=".", sep=",")
calibration[,1]
calibration <- read.csv(paste(folder_path, "population", current_generation, ".csv", sep=""), dec=".", sep=",")
calibration$nTrait <- 0
if (calibration[,1] == "true") calibration$nTrait<- calibration$nTrait + 1
if (calibration[,2] == "true") calibration$nTrait<- calibration$nTrait + 1
if (calibration[,3] == "true") calibration$nTrait<- calibration$nTrait + 1
if (calibration[,4] == "true") calibration$nTrait<- calibration$nTrait + 1
if (calibration[,5] == "true") calibration$nTrait <- calibration$nTrait + 1
calibration
nrows(calibration)
nrow(calibration)
calibration <- read.csv(paste(folder_path, "population", current_generation, ".csv", sep=""), dec=".", sep=",")
nmodels <- nrow(calibration)
calibration$nTrait <- rep(0, nmodels)
if (calibration[,1] == "true") calibration$nTrait<- calibration$nTrait + 1
if (calibration[,2] == "true") calibration$nTrait<- calibration$nTrait + 1
if (calibration[,3] == "true") calibration$nTrait<- calibration$nTrait + 1
if (calibration[,4] == "true") calibration$nTrait<- calibration$nTrait + 1
if (calibration[,5] == "true") calibration$nTrait <- calibration$nTrait + 1
calibration
str(calibration[,1])
calibration <- read.csv(paste(folder_path, "population", current_generation, ".csv", sep=""), dec=".", sep=",")
if (calibration[,1] == "true") calibration[,1]<- 1
if (calibration[,2] == "true") calibration[,2]<- 1
if (calibration[,3] == "true") calibration[,3]<- 1
if (calibration[,4] == "true") calibration[,4]<- 1
if (calibration[,5] == "true") calibration[,5] <-1
calibration$nTrait <- calibration[,1] + calibration[,2] + calibration[,3] + calibration[,4] + calibration[,5]
calibration
head(calibration)
calibration <- read.csv(paste(folder_path, "population", current_generation, ".csv", sep=""), dec=".", sep=",")
if (calibration[,1] == "true") calibration[,1]<- 1
if (calibration[,2] == "true") calibration[,2]<- 1
if (calibration[,3] == "true") calibration[,3]<- 1
if (calibration[,4] == "true") calibration[,4]<- 1
if (calibration[,5] == "true") calibration[,5] <-1
calibration$nTrait <- calibration[,1] + calibration[,2] + calibration[,3] + calibration[,4] + calibration[,5]
head(calibration)
folder_path <- "/Users/clementinecottineau/Documents/Géographie/post-doc/marius-family/"
current_generation <- input$generation
n_trait <- input$ntrait
calibration <- read.csv(paste(folder_path, "population", current_generation, ".csv", sep=""), dec=".", sep=",")
if(calibration[fr.geocites.gugus.balance.Bonus=="true"]) calibration$bonus <- 1
if(calibration[,]=="true") calibration$bonus <- 1
if(calibration[,1]=="true") calibration$bonus <- 1
current_generation <- input$generation
n_trait <- input$ntrait
calibration <- read.csv(paste(folder_path, "population", current_generation, ".csv", sep=""), dec=".", sep=",")
calibration$nTrait <- rowSums(calibration == "true")
head(calibration)
tail(calibration)
calibration
library(rgdal)
library(rgeos)
library(mapproj)
library(maptools)
library(RColorBrewer)
library(RCurl)
library(ggplot2)
library(reshape2)
library(grid)
path <- "/Users/clementinecottineau/Documents/MARIUS_Shiny/"
FSU_Reg<-readOGR(dsn = paste(path, "FSU.shp", sep="") , layer = "FSU",encoding = "utf8", stringsAsFactors = FALSE, verbose = FALSE)
Agglo<-readOGR(dsn = paste(path, "DARIUS_points.shp", sep="") , layer = "DARIUS_points", encoding = "utf8", stringsAsFactors = FALSE, verbose = FALSE)
Shape <- "Shape"
assign(Shape, FSU_Reg)
name_col <- as.data.frame(colnames(Agglo@data))
name_col$NumCol <- rownames(name_col)
colnames(name_col) <- c("name", "NumCol")
table <- mariusstep30
residuals
Agglo <- Agglo[!is.na(Agglo@data$population), ]
Agglo@data <- Agglo@data[order(-Agglo@data[,Year]) , ]
Agglo@data$Residuals <- log(Agglo@data[,Year]) - log(Agglo@data$population)
res <- Agglo@data[order(-Agglo@data$Residuals) , ]
residuals <-  cbind(res$name, res$country, round(res[,Year],0), round(res$population,0))
colnames(residuals) <- c("City","Republic", "Observed thousands", "Simulated thousands")
tail(residuals,10)
observed <- "Pop1959"
Year <- subset(name_col, name == observed)
Year <- as.numeric(Year[1,2])
Agglo@data <- data.frame(Agglo@data, table[match(Agglo@data$AROKATO,table$arokato), ])
Agglo <- Agglo[!is.na(Agglo@data$population), ]
marius <- read.csv(paste(path, "marius.csv", sep=""),sep=",",dec=".")
mariusstep0 <- subset(marius, step == 0)
mariusstep11 <- subset(marius, step == 11)
mariusstep20 <- subset(marius, step == 20)
mariusstep30 <- subset(marius, step == 30)
step0 <- mariusstep0[order(-mariusstep0$population) , ]
step0 <- step0[,3]
step11 <- mariusstep11[order(-mariusstep11$population) , ]
step11 <- step11[,3]
step20 <- mariusstep20[order(-mariusstep20$population) , ]
step20 <- step20[,3]
step30 <- mariusstep30[order(-mariusstep30$population) , ]
step30 <- step30[,3]
ranks <- 1:1145
darius <- subset(Agglo@data, Pop1959 > 0)
zipf0 <- as.data.frame(cbind (ranks, step0))
colnames(zipf0) <- c("ranks", "size")
sizes1970 <- darius[order(-darius$Pop1970) , ]
sizes1970 <- sizes1970$Pop1970
zipf1970 <- as.data.frame(cbind (ranks, sizes1970))
colnames(zipf1970) <- c("ranks", "size")
zipf11 <- as.data.frame(cbind (ranks, step11))
colnames(zipf11) <- c("ranks", "size")
sizes1979 <- darius[order(-darius$Pop1979) , ]
sizes1979 <- sizes1979$Pop1979
zipf1979 <- as.data.frame(cbind (ranks, sizes1979))
colnames(zipf1979) <- c("ranks", "size")
zipf20 <- as.data.frame(cbind (ranks, step20))
colnames(zipf20) <- c("ranks", "size")
sizes1989 <- darius[order(-darius$Pop1989) , ]
sizes1989 <- sizes1989$Pop1989
zipf1989 <- as.data.frame(cbind (ranks, sizes1989))
colnames(zipf1989) <- c("ranks", "size")
zipf30 <- as.data.frame(cbind (ranks, step30))
colnames(zipf30) <- c("ranks", "size")
zipf <- rbind(zipf0, zipf1970, zipf11, zipf1979, zipf20, zipf1989, zipf30 )
date <- c(rep("1959", 1145),rep("1970", 1145), rep("sim1970", 1145),
rep("1979", 1145), rep("sim1979", 1145), rep("1989", 1145), rep("sim1989", 1145))
zipf <- as.data.frame(cbind (zipf, date))
cols <- c( "sim1989" = "dodgerblue","1989" = "gray70","sim1979" = "dodgerblue3", "1979"= "gray60", "sim1970" = "dodgerblue4", "1970"= "gray50", "1959" = "gray30")
if (observed == "Pop1959") table <- mariusstep0
Year <- subset(name_col, name == observed)
Year <- as.numeric(Year[1,2])
Agglo@data <- data.frame(Agglo@data, table[match(Agglo@data$AROKATO,table$arokato), ])
Agglo <- Agglo[!is.na(Agglo@data$population), ]
Agglo@data <- Agglo@data[order(-Agglo@data[,Year]) , ]
Agglo@data$Residuals <- log(Agglo@data[,Year]) - log(Agglo@data$population)
Year <- subset(name_col, name == observed)
Year <- as.numeric(Year[1,2])
Agglo@data <- data.frame(Agglo@data, table[match(Agglo@data$AROKATO,table$arokato), ])
Agglo <- Agglo[!is.na(Agglo@data$population), ]
Agglo@data <- Agglo@data[order(-Agglo@data[,Year]) , ]
Agglo@data$Residuals <- log(Agglo@data[,Year]) - log(Agglo@data$population)
res <- Agglo@data[order(-Agglo@data$Residuals) , ]
residuals <-  cbind(res$name, res$country, round(res[,Year],0), round(res$population,0))
colnames(residuals) <- c("City","Republic", "Observed thousands", "Simulated thousands")
head(residuals,10)
head(res)
levelplot(mat, col.regions=my_palette, at=c(-0.5, 0.5, 1.5, 2.5))
library(lattice)
a <- "coral"
b<- "gray70"
c <- "black"
surprise = matrix(ncol=23, nrow=11)
surprise[11,] <- c(rep(0,23))
surprise[10,] <- c(0, rep(1,21), 0)
surprise[9,] <- c(0, 1, 2, 1, 2, 1, 1, 1, 2, 1, 1, 1, 2, 2, 1, 2, 2, 1, 2, 1, 2, 1, 0)
surprise[8,] <- c(0, 1, 2, 2, 2, 1, 1, 2, 2, 2, 1, 1, 2, 2, 1, 2, 2, 1, 1, 2, 1, 1, 0)
surprise[7,] <- c(0, 1, 2, 1, 2, 1, 2, 1, 1, 1, 2, 1, 2, 1, 1, 2, 1, 1, 1, 2, 1, 1, 0)
surprise[6,]<- c(0, rep(1,21), 0)
surprise[5,]<- c(0, 1, 2, 1, 2, 1, 1, 1, 2, 1, 1, 1, 2, 2, 1, 1, 2, 2, 1, 1, 2, 1, 0)
surprise[4,]<- c(0, 1, 2, 2, 2, 1, 1, 2, 2, 2, 1, 1, 2, 1, 2, 1, 2, 2, 1, 1, 2, 1, 0)
surprise[3,]<- c(0, 1, 2, 1, 2, 1, 2, 1, 1, 1, 2, 1, 2, 2, 1, 1, 2, 1, 2, 1, 2, 1, 0)
surprise[2,]<- c(0, rep(1,21), 0)
surprise[1,]<- c(rep(0,23))
mat <- t(surprise)
my_palette <- colorRampPalette(c(c, b, a))(n = 299)
levelplot(mat, col.regions=my_palette, at=c(-0.5, 0.5, 1.5, 2.5))
shiny::runApp('Documents/MARIUS_Shiny/App-1')
shiny::runApp('Documents/MARIUS_Shiny/App-1')
shiny::runApp('Documents/MARIUS_Shiny/App-1')
shiny::runApp('Documents/MARIUS_Shiny/App-1')
shiny::runApp('Documents/MARIUS_Shiny/App-1')
shiny::runApp('Documents/MARIUS_Shiny/App-1')
shiny::runApp('Documents/MARIUS_Shiny/App-1')
install.packages("manipulate")
shiny::runApp('Documents/MARIUS_Shiny/App-1')
shiny::runApp('Documents/MARIUS_Shiny/App-1')
shiny::runApp('Documents/MARIUS_Shiny/App-1')
shiny::runApp('Documents/MARIUS_Shiny/App-1')
shiny::runApp('Documents/MARIUS_Shiny/App-1')
shiny::runApp('Documents/MARIUS_Shiny/App-1')
shiny::runApp('Documents/MARIUS_Shiny/App-1')
shiny::runApp('Documents/MARIUS_Shiny/App-1')
shiny::runApp('Documents/MARIUS_Shiny/App-1')
shiny::runApp('Documents/MARIUS_Shiny/App-1')
shiny::runApp('Documents/MARIUS_Shiny/App-1')
shiny::runApp('Documents/MARIUS_Shiny/App-1')
shiny::runApp('Documents/MARIUS_Shiny/App-1')
shiny::runApp('Documents/MARIUS_Shiny/App-1')
shiny::runApp('Documents/MARIUS_Shiny/App-1')
shiny::runApp('Documents/MARIUS_Shiny/App-1')
shiny::runApp('Documents/MARIUS_Shiny/App-1')
shiny::runApp('Documents/MARIUS_Shiny/App-1')
shiny::runApp('Documents/MARIUS_Shiny/App-1')
shiny::runApp('Documents/MARIUS_Shiny/App-1')
shiny::runApp('Documents/MARIUS_Shiny/App-1')
shiny::runApp('Documents/MARIUS_Shiny/App-1')
shiny::runApp('Documents/MARIUS_Shiny/App-1')
shiny::runApp('Documents/MARIUS_Shiny/App-1')
shiny::runApp('Documents/MARIUS_Shiny/App-1')
shiny::runApp('Documents/MARIUS_Shiny/App-1')
shiny::runApp('Documents/MARIUS_Shiny/App-1')
shiny::runApp('Documents/MARIUS_Shiny/VARIUS')
shiny::runApp('Documents/MARIUS_Shiny/VARIUS')
shiny::runApp('Documents/MARIUS_Shiny/VARIUS')
---
shiny::runApp('Documents/MARIUS_Shiny/VARIUS')
shiny::runApp('Documents/MARIUS_Shiny/VARIUS')
head(calibration)
shiny::runApp('Documents/MARIUS_Shiny/VARIUS')
shiny::runApp('Documents/MARIUS_Shiny/VARIUS')
shiny::runApp('Documents/MARIUS_Shiny/VARIUS')
shiny::runApp('Documents/MARIUS_Shiny/VARIUS')
shiny::runApp('Documents/MARIUS_Shiny/VARIUS')
shiny::runApp('Documents/MARIUS_Shiny/VARIUS')
shiny::runApp('Documents/MARIUS_Shiny/VARIUS')
shiny::runApp('Documents/MARIUS_Shiny/VARIUS')
shiny::runApp('Documents/MARIUS_Shiny/VARIUS')
shiny::runApp('Documents/MARIUS_Shiny/VARIUS')
shiny::runApp('Documents/MARIUS_Shiny/VARIUS')
shiny::runApp('Documents/MARIUS_Shiny/VARIUS')
shiny::runApp('Documents/MARIUS_Shiny/VARIUS')
shiny::runApp('Documents/MARIUS_Shiny/VARIUS')
shiny::runApp('Documents/MARIUS_Shiny/VARIUS')
shiny::runApp('Documents/MARIUS_Shiny/VARIUS')
shiny::runApp('Documents/VARIUS')
shiny::runApp('Documents/VARIUS')
shiny::runApp('Documents/VARIUS')
shiny::runApp('Documents/VARIUS')
shiny::runApp('Documents/VARIUS')
shiny::runApp('Documents/VARIUS')
shiny::runApp('Documents/VARIUS')
shiny::runApp('Documents/VARIUS')
shiny::runApp('Documents/VARIUS')
shiny::runApp('Documents/VARIUS')
shiny::runApp('Documents/VARIUS')
shiny::runApp('Documents/VARIUS')
